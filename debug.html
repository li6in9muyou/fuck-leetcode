<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Load Scripts</title>
    <style>
      body {
        font-family: sans-serif;
        display: flex;
        flex-direction: column;
        justify-content: start;
        align-items: center;
        min-height: 98vh;
        text-align: center;
        background-color: #121212;
        color: #e0e0e0;
      }
      h1 {
        color: #8ab4f8;
      }
      p {
        max-width: 600px;
        padding: 0 20px;
        font-size: 1.1rem;
      }
      #loaded-files-container {
        margin-top: 20px;
        width: 100%;
        text-align: left;
        padding: 12px 16px;
        box-sizing: border-box;
      }
      #loaded-files-container h2 {
        margin-top: 0;
        color: #9cdcfe;
      }
      #loaded-files-list {
        list-style-type: none;
        padding: 0;
        margin: 0;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 12px;
      }
      #loaded-files-list li {
        background-color: #1b1b1b;
        border: 1px solid #2a2a2a;
        color: #e0e0e0;
        padding: 10px 12px;
        border-radius: 8px;
        text-align: center;
        font-size: 0.95rem;
        word-break: break-word;
      }
      #loaded-files-list li:hover {
        border-color: #3a3a3a;
        background-color: #202020;
      }
    </style>
    <script src="./runtime.js"></script>
    <script>
      const numbersToLoad = [];
      for (let i = 1; i <= 200; i++) {
        numbersToLoad.push(i);
      }
      for (let i = 1000; i <= 1050; i++) {
        numbersToLoad.push(i);
      }

      // Create a promise to track the loading status of this script
      const promises = [];
      numbersToLoad.forEach((number) => {
        const script = document.createElement("script");
        const scriptName = `${number}.js`;
        script.src = scriptName;
        const promise = new Promise((resolve) => {
          script.onload = () =>
            resolve({ status: "fulfilled", value: scriptName });
          script.onerror = () =>
            resolve({
              status: "rejected",
              reason: `Failed to load ${scriptName}`,
            });
        });
        promises.push(promise);
        document.head.appendChild(script);
      });

      // Wait for all scripts to finish attempting to load
      Promise.allSettled(promises).then((results) => {
        const loadedFilesList = document.getElementById("loaded-files-list");
        const loadedCountSpan = document.getElementById("loaded-count");
        let loadedCount = 0;

        results.forEach((result) => {
          result = result.value;
          if (result.status === "fulfilled") {
            const listItem = document.createElement("li");
            listItem.textContent = result.value;
            loadedFilesList.appendChild(listItem);
            loadedCount++;
          }
        });

        if (loadedCountSpan) {
          loadedCountSpan.textContent = loadedCount;
        }
      });
    </script>
  </head>
  <body>
    <div id="loaded-files-container">
      <h2>Successfully Loaded (<span id="loaded-count">0</span>)</h2>
      <ul id="loaded-files-list"></ul>
    </div>
  </body>
</html>
